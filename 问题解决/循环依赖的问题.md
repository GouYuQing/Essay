# angular循环依赖的问题

## 1.问题展示

每次编译angular项目的时候，会弹出这样的警告，说检测到了 循环依赖

```js
Circular dependency detected
A组件->B组件->A组件
```

## 2.产生原因

多个组件之间相互引用，形成闭环，比如A组件->B组件->A组件

## 3.场景及解决办法

###  （1）场景一：数据和方法引用

```js
\brand-data-analysis\open-group-info\open-group-info.component.ts -> \brand-data-analysis\brand-data-analysis.component.ts -> brand-data-analysis\open-group-info\open-group-info.component.ts
```

场景：A组件是父组件，B组件是A组件的子组件（A引入了B），然后B又导入使用了A的一些数据或者方法（导致B引用了A）

```js
//解决办法：新建interface.ts文件，将公用的数据提出到该文件里面，如果是公共的方法就放到新的service.ts文件里面
//interface.ts
export const enum typeEnum{
    a,
    b,
}
//service.ts
@Injectaable({
	providedIn: "root",
})
export class FileService{
    constuctor(){}
    public someFunctions():void{}//公用的方法
}
```

[【angular官网描述循环依赖错误】](https://angular.cn/errors/NG3003)

 ### （2）场景二： service文件之间相互引用

```js
export class FileService{
    constructor(private imagService: ImagService)
    //用了一些imagService方法
}

export class ImagService{
    constructor(private fileService: FileService)
    //用了一些fileService里面的方法
}
```

```js
//解决办法 换一个依赖注入的方式
private fileService:FileService;
constructor(injector:Injector) {
  this.fileService = injector.get(FileService);
}
```

 ### （3）场景三：多个组件之间相互引用

多个组件之间相互引用，可以提供服务监听数据变化，进行数据的通知，Subject



